"use strict";exports.ids=["654"],exports.modules={2629:function(e,t,r){r.r(t),r.d(t,{createPluginRuntime:()=>eW,PluginConfigurationError:()=>i,PluginRuntime:()=>eB,getNormalizedRemoteName:()=>eD,createPlugin:()=>s,CommonPluginErrors:()=>a});var n=r(2059);class i extends n.Data.TaggedError("PluginConfigurationError"){get name(){return"PluginConfigurationError"}}var o=r(9873),l=r(1522);let a={UNAUTHORIZED:{data:l.z.object({apiKeyProvided:l.z.boolean(),provider:l.z.string().optional(),authType:l.z.enum(["apiKey","oauth","token"]).optional()})},RATE_LIMITED:{data:l.z.object({retryAfter:l.z.number().int().min(1),remainingRequests:l.z.number().int().min(0).optional(),resetTime:l.z.string().datetime().optional(),limitType:l.z.enum(["requests","tokens","bandwidth"]).optional()})},SERVICE_UNAVAILABLE:{data:l.z.object({retryAfter:l.z.number().int().optional(),maintenanceWindow:l.z.boolean().default(!1),estimatedUptime:l.z.string().datetime().optional()})},BAD_REQUEST:{data:l.z.object({invalidFields:l.z.array(l.z.string()).optional(),validationErrors:l.z.array(l.z.object({field:l.z.string(),message:l.z.string(),code:l.z.string().optional()})).optional()})},NOT_FOUND:{data:l.z.object({resource:l.z.string().optional(),resourceId:l.z.string().optional()})},FORBIDDEN:{data:l.z.object({requiredPermissions:l.z.array(l.z.string()).optional(),action:l.z.string().optional()})}};function s(e){let t={variables:e.variables,secrets:e.secrets};class r{id=e.id;contract=e.contract;configSchema=t;_context=null;initialize(t){return(e.initialize??(()=>n.Effect.succeed({})))(t).pipe(n.Effect.tap(e=>n.Effect.sync(()=>{this._context=e})),n.Effect.map(()=>this._context),n.Effect.mapError(e=>e))}shutdown(){let t=this;return n.Effect.gen(function*(){e.shutdown&&t._context&&(yield*e.shutdown(t._context).pipe(n.Effect.catchAll(()=>n.Effect.void)))})}createRouter(t){let r=(0,o.implement)(e.contract).$context();return e.createRouter(t,r)}}let i=r;return i.binding={contract:e.contract,config:t},i}function u(e){if(!e)throw Error("InitializedPlugin is undefined - plugin initialization failed");if(!e.plugin)throw Error("Plugin instance is undefined - check service layer dependencies (ModuleFederationService, SecretsService)");if("function"!=typeof e.plugin.createRouter)throw Error(`Plugin ${e.plugin.id||"unknown"} does not have a createRouter method`);if(!e.context)throw Error("Plugin context is undefined - plugin initialization incomplete");return e.plugin.createRouter(e.context)}function c(e,t){let r=u(e);return(0,o.createRouterClient)(r,t)}var f=r(3876);class d extends n.Data.TaggedError("PluginRuntimeError"){}class p extends n.Data.TaggedError("ModuleFederationError"){}class h extends n.Data.TaggedError("ValidationError"){}let g=e=>{switch(e){case"TOO_MANY_REQUESTS":case"SERVICE_UNAVAILABLE":case"BAD_GATEWAY":case"GATEWAY_TIMEOUT":case"TIMEOUT":return!0;default:return!1}},E=(e,t,r,n)=>new d({pluginId:t,operation:n,procedureName:r,retryable:g(e.code),cause:e}),y=(e,t,r,n,i=!1)=>e instanceof f.ORPCError?E(e,t,r,n):e instanceof d?e:new d({pluginId:t,operation:n,procedureName:r,retryable:i,cause:e instanceof Error?e:Error(String(e))});var m=Object.defineProperty,_=Object.defineProperties,v=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,$=(e,t,r)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,R=(e,t)=>{for(var r in t||(t={}))w.call(t,r)&&$(e,r,t[r]);if(b)for(var r of b(t))P.call(t,r)&&$(e,r,t[r]);return e},S=(e,t)=>_(e,v(t)),O=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},A=async(e,t)=>{var r,n,i,o,l,a;let s=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:s,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let n=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));s=n.options||s,e=n.url}u.onRequest.push(null==(n=c.hooks)?void 0:n.onRequest),u.onResponse.push(null==(i=c.hooks)?void 0:i.onResponse),u.onSuccess.push(null==(o=c.hooks)?void 0:o.onSuccess),u.onError.push(null==(l=c.hooks)?void 0:l.onError),u.onRetry.push(null==(a=c.hooks)?void 0:a.onRetry)}return{url:e,options:s,hooks:u}},T=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},N=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}};function x(e){if("number"==typeof e)return new T({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new T(e);case"exponential":return new N(e);default:throw Error("Invalid retry strategy")}}var D=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let n=r(e.auth.username),i=r(e.auth.password);if(!n||!i)return t;t.authorization=`Basic ${btoa(`${n}:${i}`)}`}else if("Custom"===e.auth.type){let n=r(e.auth.value);if(!n)return t;t.authorization=`${r(e.auth.prefix)} ${n}`}}return t},I=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function j(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return I.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}function L(e){try{return JSON.parse(e),!0}catch(e){return!1}}function z(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function C(e){try{return JSON.parse(e)}catch(t){return e}}function F(e){return"function"==typeof e}function k(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&F(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&F(window.fetch))return window.fetch;throw Error("No fetch implementation found")}async function M(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await D(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=H(null==e?void 0:e.body);r&&t.set("content-type",r)}return t}function H(e){return z(e)?"application/json":null}function U(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(z(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return e.body}function G(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return q.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}function V(e,t){let r;return!(null==e?void 0:e.signal)&&(null==e?void 0:e.timeout)&&(r=setTimeout(()=>null==t?void 0:t.abort(),null==e?void 0:e.timeout)),{abortTimeout:r,clearTimeout:()=>{r&&clearTimeout(r)}}}var B=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function W(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new B(r.issues);return r.value}var q=["get","post","put","patch","delete"];function Y(e,t){let{baseURL:r,params:n,query:i}=t||{query:{},params:{},baseURL:""},o=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];q.includes(t)&&(e=e.replace(`@${t}/`,"/"))}o.endsWith("/")||(o+="/");let[l,a]=e.replace(o,"").split("?"),s=new URLSearchParams(a);for(let[e,t]of Object.entries(i||{}))null!=t&&s.set(e,String(t));if(n)if(Array.isArray(n))for(let[e,t]of l.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];l=l.replace(t,r)}else for(let[e,t]of Object.entries(n))l=l.replace(`:${e}`,String(t));(l=l.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(l=l.slice(1));let u=s.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",o.startsWith("http"))?new URL(`${l}${u}`,o):`${o}${l}${u}`}var J=async(e,t)=>{var r,n,i,o,l,a,s,u;let{hooks:c,url:f,options:d}=await A(e,t),p=k(d),h=new AbortController,g=null!=(r=d.signal)?r:h.signal,E=Y(f,d),y=U(d),m=await M(d),_=G(f,d),v=S(R({},d),{url:E,headers:m,body:y,method:_,signal:g});for(let e of c.onRequest)if(e){let t=await e(v);t instanceof Object&&(v=t)}("pipeTo"in v&&"function"==typeof v.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in v)&&(v.duplex="half");let{clearTimeout:b}=V(d,h),w=await p(v.url,v);b();let P={response:w,request:v};for(let e of c.onResponse)if(e){let r=await e(S(R({},P),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?w.clone():w}));r instanceof Response?w=r:r instanceof Object&&(w=r.response)}if(w.ok){if("HEAD"===v.method)return{data:"",error:null};let e=j(w),r={data:"",response:w,request:v};if("json"===e||"text"===e){let e=await w.text(),t=null!=(o=v.jsonParser)?o:C;r.data=await t(e)}else r.data=await w[e]();for(let e of((null==v?void 0:v.output)&&v.output&&!v.disableValidation&&(r.data=await W(v.output,r.data)),c.onSuccess))e&&await e(S(R({},r),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?w.clone():w}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let $=null!=(a=null==t?void 0:t.jsonParser)?a:C,T=await w.text(),N=L(T),D=N?await $(T):null,I={response:w,responseText:T,request:v,error:S(R({},D),{status:w.status,statusText:w.statusText})};for(let e of c.onError)e&&await e(S(R({},I),{response:(null==(s=null==t?void 0:t.hookOptions)?void 0:s.cloneResponse)?w.clone():w}));if(null==t?void 0:t.retry){let r=x(t.retry),n=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(n,w)){for(let e of c.onRetry)e&&await e(P);let i=r.getDelay(n);return await new Promise(e=>setTimeout(e,i)),await J(e,S(R({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new O(w.status,w.statusText,N?D:T);return{data:null,error:S(R({},D),{status:w.status,statusText:w.statusText})}},K=r(2713),Z=r(340);let Q="[ Federation Runtime ]",X=(0,Z.h)(Q);Object.prototype.toString;let ee="object"==typeof globalThis?globalThis:window,et=(()=>{try{return document.defaultView}catch(e){return ee}})();function er(e,t,r){Object.defineProperty(e,t,{value:r,configurable:!1,writable:!0})}function en(e,t){return Object.hasOwnProperty.call(e,t)}en(ee,"__GLOBAL_LOADING_REMOTE_ENTRY__")||er(ee,"__GLOBAL_LOADING_REMOTE_ENTRY__",{});ee.__GLOBAL_LOADING_REMOTE_ENTRY__;function ei(e){var t,r,n,i,o,l,a,s,u,c,f,d;en(e,"__VMOK__")&&!en(e,"__FEDERATION__")&&er(e,"__FEDERATION__",e.__VMOK__),en(e,"__FEDERATION__")||(er(e,"__FEDERATION__",{__GLOBAL_PLUGIN__:[],__INSTANCES__:[],moduleInfo:{},__SHARE__:{},__MANIFEST_LOADING__:{},__PRELOADED_MAP__:new Map}),er(e,"__VMOK__",e.__FEDERATION__)),null!=(a=(t=e.__FEDERATION__).__GLOBAL_PLUGIN__)||(t.__GLOBAL_PLUGIN__=[]),null!=(s=(r=e.__FEDERATION__).__INSTANCES__)||(r.__INSTANCES__=[]),null!=(u=(n=e.__FEDERATION__).moduleInfo)||(n.moduleInfo={}),null!=(c=(i=e.__FEDERATION__).__SHARE__)||(i.__SHARE__={}),null!=(f=(o=e.__FEDERATION__).__MANIFEST_LOADING__)||(o.__MANIFEST_LOADING__={}),null!=(d=(l=e.__FEDERATION__).__PRELOADED_MAP__)||(l.__PRELOADED_MAP__=new Map)}function eo(e){ee.__FEDERATION__.__INSTANCES__.push(e)}ei(ee),ei(et);let el="[0-9A-Za-z-]+",ea=`(?:\\+(${el}(?:\\.${el})*))`,es="0|[1-9]\\d*",eu="[0-9]+",ec="\\d*[a-zA-Z-][a-zA-Z0-9-]*",ef=`(?:${eu}|${ec})`,ed=`(?:-?(${ef}(?:\\.${ef})*))`,ep=`(?:${es}|${ec})`,eh=`(?:-(${ep}(?:\\.${ep})*))`,eg=`${es}|x|X|\\*`,eE=`[v=\\s]*(${eg})(?:\\.(${eg})(?:\\.(${eg})(?:${eh})?${ea}?)?)?`,ey=`^\\s*(${eE})\\s+-\\s+(${eE})\\s*$`,em=`(${eu})\\.(${eu})\\.(${eu})`,e_=`[v=\\s]*${em}${ed}?${ea}?`,ev="((?:<|>)?=?)",eb=`(\\s*)${ev}\\s*(${e_}|${eE})`,ew="(?:~>?)",eP=`(\\s*)${ew}\\s+`,e$="(?:\\^)",eR=`(\\s*)${e$}\\s+`,eS=`^${e$}${eE}$`,eO=`(${es})\\.(${es})\\.(${es})`,eA=`v?${eO}${eh}?${ea}?`,eT=`^${ew}${eE}$`,eN=`^${ev}\\s*${eE}$`,ex=`^${ev}\\s*(${eA})$|^$`,eD=e=>e.toLowerCase().replace(/^@/,"").replace(/\//g,"_");var eI=JSON.parse('{"rE":"0.3.2","El":{"Wl":"^1.10.0","lh":"^1.10.0","QZ":"3.18.1","gk":"4.1.5"}}');let ej=n.Effect.cached(n.Effect.sync(()=>{try{let e=(0,K.getInstance)();return e||(e=(0,K.createInstance)({name:"host",remotes:[],shared:{"every-plugin":{version:eI.rE,shareConfig:{singleton:!0,requiredVersion:`^${eI.rE}`,eager:!0,strictVersion:!0}},effect:{version:eI.El.QZ,shareConfig:{singleton:!0,requiredVersion:"^3.18.0",eager:!0,strictVersion:!0}},zod:{version:eI.El.gk,shareConfig:{singleton:!0,requiredVersion:"^4.1.0",eager:!0,strictVersion:!0}},"@orpc/contract":{version:eI.El.Wl,shareConfig:{singleton:!0,requiredVersion:"^1.8.0",eager:!0,strictVersion:!0}},"@orpc/server":{version:eI.El.lh,shareConfig:{singleton:!0,requiredVersion:"^1.8.0",eager:!0,strictVersion:!0}}}}),eo(e)),e}catch(e){throw Error(`Failed to initialize Module Federation: ${e}`)}}));class eL extends n.Effect.Service()("ModuleFederationService",{effect:n.Effect.gen(function*(){let e=yield*n.Effect.flatten(ej);return{registerRemote:(t,r)=>n.Effect.gen(function*(){console.log(`[MF] Registering ${t}`);let{error:i}=yield*n.Effect.tryPromise({try:()=>J(r,{method:"HEAD"}),catch:e=>new p({pluginId:t,remoteUrl:r,cause:e instanceof Error?e:Error(String(e))})});if(i)return console.log(`[MF] ❌ Remote not available for ${t}`),yield*n.Effect.fail(new p({pluginId:t,remoteUrl:r,cause:Error(`Remote not available (${r}): ${JSON.stringify(i)}`)}));let o=eD(t);yield*n.Effect.try({try:()=>e.registerRemotes([{name:o,entry:r}]),catch:e=>new p({pluginId:t,remoteUrl:r,cause:e instanceof Error?e:Error(String(e))})}),console.log(`[MF] ✅ Registered ${t}`)}),loadRemoteConstructor:(t,r)=>n.Effect.gen(function*(){let i=eD(t);console.log(`[MF] Loading remote ${i}`);let o=`${i}/plugin`;return yield*n.Effect.tryPromise({try:async()=>{let r=await e.loadRemote(o);if(!r)throw Error(`No container returned for ${o}`);let n="function"==typeof r?r:r.default;if(!n||"function"!=typeof n)throw Error(`No valid constructor found. Container type: ${typeof r}`);return console.log(`[MF] ✅ Loaded constructor for ${t}`),n},catch:e=>new p({pluginId:t,remoteUrl:r,cause:e instanceof Error?e:Error(String(e))})})})}})}){}class ez extends n.Effect.Service()("PluginLifecycleService",{effect:n.Effect.gen(function*(){let e=yield*n.Ref.make(new Set);return{register:t=>n.Ref.update(e,e=>new Set(e).add(t)),unregister:t=>n.Ref.update(e,e=>{let r=new Set(e);return r.delete(t),r}),shutdown:t=>n.Effect.gen(function*(){yield*n.Ref.update(e,e=>{let r=new Set(e);return r.delete(t),r}),yield*t.plugin.shutdown().pipe(n.Effect.mapError(e=>y(e,t.plugin.id,void 0,"shutdown-plugin",!1)))}),cleanup:()=>n.Effect.gen(function*(){let t=yield*n.Ref.get(e);yield*n.Effect.forEach(t,e=>e.plugin.shutdown().pipe(n.Effect.mapError(t=>y(t,e.plugin.id,void 0,"cleanup-shutdown",!1)),n.Effect.catchAll(t=>n.Effect.logError(`Failed to shutdown plugin ${e.plugin.id} during cleanup`,t,{pluginId:e.plugin.id}))),{concurrency:"unbounded"}),yield*n.Ref.set(e,new Set)}).pipe(n.Effect.catchAll(()=>n.Effect.void))}})}){}let eC=(e,t,r,i)=>n.Effect.gen(function*(){let o=e.safeParse(t);return o.success?o.data:yield*n.Effect.fail(new h({pluginId:r,stage:i,zodError:o.error}))}),eF=l.z.object({secrets:l.z.record(l.z.string(),l.z.unknown())}).loose();class ek extends n.Context.Tag("SecretsConfig")(){}class eM extends n.Effect.Service()("SecretsService",{effect:n.Effect.gen(function*(){let e=yield*ek;return{hydrateSecrets:t=>n.Effect.gen(function*(){let r=eF.parse(t);try{let t=JSON.stringify(r),n=t;for(let[t,r]of Object.entries(e)){let e=RegExp(`{{${t}}}`,"g");n=n.replace(e,String(r))}return JSON.parse(n)}catch(e){return yield*n.Effect.fail(new d({operation:"hydrate-secrets",cause:e instanceof Error?e:Error(String(e)),retryable:!1}))}})}})}){}class eH extends n.Context.Tag("PluginRegistry")(){}class eU extends n.Effect.Service()("RegistryService",{effect:n.Effect.gen(function*(){let e=yield*eH;return{get:t=>n.Effect.fromNullable(e[t]).pipe(n.Effect.mapError(()=>new d({pluginId:t,operation:"load-plugin",cause:Error(`Plugin ${t} not found in registry`),retryable:!1})))}})}){}class eG extends n.Effect.Service()("PluginLoaderService",{effect:n.Effect.gen(function*(){let e=yield*eL,t=yield*eM,r=yield*eU,i=(e,t)=>t&&"latest"!==t?e.replace("@latest",`@${t}`):e,o=e=>r.get(e);return{loadPlugin:t=>n.Effect.gen(function*(){let r=yield*o(t),l=i(r.remoteUrl);yield*e.registerRemote(t,l).pipe(n.Effect.mapError(e=>y(e.cause,t,void 0,"register-remote",!0))),yield*n.Effect.logDebug("Loading plugin",{pluginId:t,url:l});let a=yield*e.loadRemoteConstructor(t,l).pipe(n.Effect.mapError(e=>y(e.cause,t,void 0,"load-remote",!1)));return{ctor:a,metadata:r}}),instantiatePlugin:(e,t)=>n.Effect.gen(function*(){let r=yield*n.Effect.try(()=>new t.ctor).pipe(n.Effect.mapError(t=>y(t,e,void 0,"instantiate-plugin",!1)));return r.id!==e?yield*n.Effect.fail(new d({pluginId:e,operation:"validate-plugin-id",cause:Error(`Plugin ID mismatch: expected ${e}, got ${r.id}`),retryable:!1})):{plugin:r,metadata:t.metadata}}),initializePlugin:(e,r)=>n.Effect.gen(function*(){let{plugin:i}=e,o=yield*eC(i.configSchema.variables,r.variables,i.id,"config").pipe(n.Effect.mapError(e=>new d({pluginId:i.id,operation:"validate-config",cause:e.zodError,retryable:!1}))),l=yield*eC(i.configSchema.secrets,r.secrets,i.id,"config").pipe(n.Effect.mapError(e=>new d({pluginId:i.id,operation:"validate-secrets",cause:e.zodError,retryable:!1}))),a=yield*t.hydrateSecrets({variables:o,secrets:l}),s=yield*eC(i.configSchema.variables,a.variables,i.id,"config").pipe(n.Effect.mapError(e=>new d({pluginId:i.id,operation:"validate-hydrated-config",cause:e.zodError,retryable:!1}))),u=yield*n.Scope.make(),c=yield*i.initialize({variables:s,secrets:a.secrets}).pipe(n.Effect.provideService(n.Scope.Scope,u),n.Effect.mapError(e=>y(e,i.id,void 0,"initialize-plugin",!1)));return{plugin:i,metadata:e.metadata,config:{variables:s,secrets:a.secrets},context:c,scope:u}})}})}){}class eV extends n.Effect.Service()("PluginService",{scoped:n.Effect.gen(function*(){let e=yield*eG,t=yield*ez;return{loadPlugin:e.loadPlugin,instantiatePlugin:e.instantiatePlugin,initializePlugin:e.initializePlugin,shutdownPlugin:e=>n.Effect.gen(function*(){yield*e.plugin.shutdown().pipe(n.Effect.catchAll(()=>n.Effect.void)),yield*n.Scope.close(e.scope,n.Exit.succeed(void 0)),yield*t.unregister(e)}),cleanup:t.cleanup}})}){static Live=(e,t)=>{let r=n.Layer.mergeAll(n.Layer.succeed(eH,e),n.Layer.succeed(ek,t)),i=n.Layer.mergeAll(eL.Default,eM.Default,eU.Default,ez.Default).pipe(n.Layer.provide(r));return eV.Default.pipe(n.Layer.provide(eG.Default),n.Layer.provide(i))}}class eB{runtime;registry;pluginCache=new Map;constructor(e,t){this.runtime=e,this.registry=t}generateCacheKey(e,t){let r=n.Hash.structure(t).toString();return`${e}:${r}`}validatePluginId(e){let t=e;return t in this.registry?n.Effect.succeed(t):n.Effect.fail(new d({pluginId:t,operation:"validate-plugin-id",cause:Error(`Plugin ID '${t}' not found in registry`),retryable:!1}))}async runPromise(e){let t=await this.runtime.runPromiseExit(e);if(n.Exit.isFailure(t)){let e=n.Cause.failureOption(t.cause);if(n.Option.isSome(e))throw e.value;throw n.Cause.squash(t.cause)}return t.value}loadPlugin(e){let t=n.Effect.gen(this,function*(){let t=yield*eV,r=yield*this.validatePluginId(e);return yield*t.loadPlugin(r)});return this.runPromise(t)}instantiatePlugin(e,t){let r=n.Effect.gen(this,function*(){let r=yield*eV,n=e;return yield*r.instantiatePlugin(n,t)});return this.runPromise(r)}initializePlugin(e,t){let r=n.Effect.gen(this,function*(){let r=yield*eV;return yield*r.initializePlugin(e,t)});return this.runPromise(r)}async usePlugin(e,t){let r=this.generateCacheKey(String(e),t),i=this.pluginCache.get(r);if(!i){let o=n.Effect.gen(this,function*(){let r=yield*eV,n=yield*this.validatePluginId(e),i=yield*r.loadPlugin(n),o=yield*r.instantiatePlugin(String(e),i),l=yield*r.initializePlugin(o,t);return{client:c(l),router:u(l),metadata:l.metadata,initialized:l}}).pipe(n.Effect.provide(this.runtime));i=n.Effect.cached(o).pipe(n.Effect.flatten),this.pluginCache.set(r,i)}return this.runPromise(i)}shutdown(){let e=n.Effect.gen(function*(){let e=yield*eV;yield*e.cleanup()});return this.runPromise(e)}evictPlugin(e,t){let r=this.generateCacheKey(String(e),t),i=n.Effect.gen(this,function*(){let e=yield*eV,t=this.pluginCache.get(r);if(t){this.pluginCache.delete(r);let i=yield*t.pipe(n.Effect.catchAll(()=>n.Effect.succeed(null)));i?.initialized&&(yield*e.shutdownPlugin(i.initialized).pipe(n.Effect.catchAll(()=>n.Effect.void)))}}).pipe(n.Effect.catchAll(()=>n.Effect.void));return this.runPromise(i)}}function eW(e){let t=e.secrets||{},r=eV.Live(e.registry,t);return new eB(n.ManagedRuntime.make(r),e.registry)}},2713:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(6264),t)},6264:function(e,t,r){var n=r(2676);Object.prototype.hasOwnProperty.call(n,"__proto__")&&!Object.prototype.hasOwnProperty.call(t,"__proto__")&&Object.defineProperty(t,"__proto__",{enumerable:!0,value:n.__proto__}),Object.keys(n).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||(t[e]=n[e])})},340:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{h:()=>createLogger});var _polyfills_esm_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(632);let FederationModuleManifest="federation-manifest.json",MANIFEST_EXT=".json",BROWSER_LOG_KEY="FEDERATION_DEBUG",NameTransformSymbol={AT:"@",HYPHEN:"-",SLASH:"/"},NameTransformMap={[NameTransformSymbol.AT]:"scope_",[NameTransformSymbol.HYPHEN]:"_",[NameTransformSymbol.SLASH]:"__"},EncodedNameTransformMap={[NameTransformMap[NameTransformSymbol.AT]]:NameTransformSymbol.AT,[NameTransformMap[NameTransformSymbol.HYPHEN]]:NameTransformSymbol.HYPHEN,[NameTransformMap[NameTransformSymbol.SLASH]]:NameTransformSymbol.SLASH},SEPARATOR=":",ManifestFileName="mf-manifest.json",StatsFileName="mf-stats.json",MFModuleType={},MODULE_DEVTOOL_IDENTIFIER="__MF_DEVTOOLS_MODULE_INFO__",ENCODE_NAME_PREFIX="ENCODE_NAME_PREFIX",TEMP_DIR=".federation",MFPrefetchCommon={};var ContainerPlugin=Object.freeze({__proto__:null}),ContainerReferencePlugin=Object.freeze({__proto__:null}),ModuleFederationPlugin=Object.freeze({__proto__:null}),SharePlugin=Object.freeze({__proto__:null});function isBrowserEnv(){return"undefined"!=typeof window&&void 0!==window.document}function isReactNativeEnv(){var e;return"undefined"!=typeof navigator&&(null==(e=navigator)?void 0:e.product)==="ReactNative"}function isBrowserDebug(){try{if(isBrowserEnv()&&window.localStorage)return!!localStorage.getItem(BROWSER_LOG_KEY)}catch(e){}return!1}function isDebugMode(){return"undefined"!=typeof process&&process.env&&process.env.FEDERATION_DEBUG?!!process.env.FEDERATION_DEBUG:!!("undefined"!=typeof FEDERATION_DEBUG&&FEDERATION_DEBUG)||isBrowserDebug()}let getProcessEnv=function(){return"undefined"!=typeof process&&process.env?process.env:{}},LOG_CATEGORY="[ Federation Runtime ]",parseEntry=(e,t,r=SEPARATOR)=>{let n=e.split(r),i="development"===getProcessEnv().NODE_ENV&&t,o="*",l=e=>e.startsWith("http")||e.includes(MANIFEST_EXT);if(n.length>=2){let[t,...a]=n;e.startsWith(r)&&(t=n.slice(0,2).join(r),a=[i||n.slice(2).join(r)]);let s=i||a.join(r);return l(s)?{name:t,entry:s}:{name:t,version:s||o}}if(1===n.length){let[e]=n;return i&&l(i)?{name:e,entry:i}:{name:e,version:i||o}}throw`Invalid entry value: ${e}`},composeKeyWithSeparator=function(...e){return e.length?e.reduce((e,t)=>t?e?`${e}${SEPARATOR}${t}`:t:e,""):""},encodeName=function(e,t="",r=!1){try{let n=r?".js":"";return`${t}${e.replace(RegExp(`${NameTransformSymbol.AT}`,"g"),NameTransformMap[NameTransformSymbol.AT]).replace(RegExp(`${NameTransformSymbol.HYPHEN}`,"g"),NameTransformMap[NameTransformSymbol.HYPHEN]).replace(RegExp(`${NameTransformSymbol.SLASH}`,"g"),NameTransformMap[NameTransformSymbol.SLASH])}${n}`}catch(e){throw e}},decodeName=function(e,t,r){try{let n=e;if(t){if(!n.startsWith(t))return n;n=n.replace(RegExp(t,"g"),"")}return n=n.replace(RegExp(`${NameTransformMap[NameTransformSymbol.AT]}`,"g"),EncodedNameTransformMap[NameTransformMap[NameTransformSymbol.AT]]).replace(RegExp(`${NameTransformMap[NameTransformSymbol.SLASH]}`,"g"),EncodedNameTransformMap[NameTransformMap[NameTransformSymbol.SLASH]]).replace(RegExp(`${NameTransformMap[NameTransformSymbol.HYPHEN]}`,"g"),EncodedNameTransformMap[NameTransformMap[NameTransformSymbol.HYPHEN]]),r&&(n=n.replace(".js","")),n}catch(e){throw e}},generateExposeFilename=(e,t)=>{if(!e)return"";let r=e;return"."===r&&(r="default_export"),r.startsWith("./")&&(r=r.replace("./","")),encodeName(r,"__federation_expose_",t)},generateShareFilename=(e,t)=>e?encodeName(e,"__federation_shared_",t):"",getResourceUrl=(e,t)=>{if("getPublicPath"in e){let r;return r=e.getPublicPath.startsWith("function")?Function("return "+e.getPublicPath)()():Function(e.getPublicPath)(),`${r}${t}`}return"publicPath"in e?!isBrowserEnv()&&!isReactNativeEnv()&&"ssrPublicPath"in e?`${e.ssrPublicPath}${t}`:`${e.publicPath}${t}`:(console.warn("Cannot get resource URL. If in debug mode, please ignore.",e,t),"")},assert=(e,t)=>{e||error(t)},error=e=>{throw Error(`${LOG_CATEGORY}: ${e}`)},warn=e=>{console.warn(`${LOG_CATEGORY}: ${e}`)};function safeToString(e){try{return JSON.stringify(e,null,2)}catch(e){return""}}let VERSION_PATTERN_REGEXP=/^([\d^=v<>~]|[*xX]$)/;function isRequiredVersion(e){return VERSION_PATTERN_REGEXP.test(e)}let simpleJoinRemoteEntry=(e,t)=>{if(!e)return t;let r=(e=>{if("."===e)return"";if(e.startsWith("./"))return e.replace("./","");if(e.startsWith("/")){let t=e.slice(1);return t.endsWith("/")?t.slice(0,-1):t}return e})(e);return r?r.endsWith("/")?`${r}${t}`:`${r}/${t}`:t};function inferAutoPublicPath(e){return e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/")}function generateSnapshotFromManifest(e,t={}){var r,n,i;let o,{remotes:l={},overrides:a={},version:s}=t,u=()=>"publicPath"in e.metaData?"auto"===e.metaData.publicPath&&s?inferAutoPublicPath(s):e.metaData.publicPath:e.metaData.getPublicPath,c=Object.keys(a),f={};Object.keys(l).length||(f=(null==(i=e.remotes)?void 0:i.reduce((e,t)=>{let r,n=t.federationContainerName;return r=c.includes(n)?a[n]:"version"in t?t.version:t.entry,e[n]={matchedVersion:r},e},{}))||{}),Object.keys(l).forEach(e=>f[e]={matchedVersion:c.includes(e)?a[e]:l[e]});let{remoteEntry:{path:d,name:p,type:h},types:g,buildInfo:{buildVersion:E},globalName:y,ssrRemoteEntry:m}=e.metaData,{exposes:_}=e,v={version:s||"",buildVersion:E,globalName:y,remoteEntry:simpleJoinRemoteEntry(d,p),remoteEntryType:h,remoteTypes:simpleJoinRemoteEntry(g.path,g.name),remoteTypesZip:g.zip||"",remoteTypesAPI:g.api||"",remotesInfo:f,shared:null==e?void 0:e.shared.map(e=>({assets:e.assets,sharedName:e.name,version:e.version})),modules:null==_?void 0:_.map(e=>({moduleName:e.name,modulePath:e.path,assets:e.assets}))};if(null==(r=e.metaData)?void 0:r.prefetchInterface){let t=e.metaData.prefetchInterface;v=(0,_polyfills_esm_js__WEBPACK_IMPORTED_MODULE_0__._)({},v,{prefetchInterface:t})}if(null==(n=e.metaData)?void 0:n.prefetchEntry){let{path:t,name:r,type:n}=e.metaData.prefetchEntry;v=(0,_polyfills_esm_js__WEBPACK_IMPORTED_MODULE_0__._)({},v,{prefetchEntry:simpleJoinRemoteEntry(t,r),prefetchEntryType:n})}return o="publicPath"in e.metaData?(0,_polyfills_esm_js__WEBPACK_IMPORTED_MODULE_0__._)({},v,{publicPath:u(),ssrPublicPath:e.metaData.ssrPublicPath}):(0,_polyfills_esm_js__WEBPACK_IMPORTED_MODULE_0__._)({},v,{getPublicPath:u()}),m&&(o.ssrRemoteEntry=simpleJoinRemoteEntry(m.path,m.name),o.ssrRemoteEntryType=m.type||"commonjs-module"),o}function isManifestProvider(e){return!!("remoteEntry"in e&&e.remoteEntry.includes(MANIFEST_EXT))}let PREFIX="[ Module Federation ]",Logger=class{setPrefix(e){this.prefix=e}log(...e){console.log(this.prefix,...e)}warn(...e){console.log(this.prefix,...e)}error(...e){console.log(this.prefix,...e)}success(...e){console.log(this.prefix,...e)}info(...e){console.log(this.prefix,...e)}ready(...e){console.log(this.prefix,...e)}debug(...e){isDebugMode()&&console.log(this.prefix,...e)}constructor(e){this.prefix=e}};function createLogger(e){return new Logger(e)}let logger=createLogger(PREFIX);async function safeWrapper(e,t){try{return await e()}catch(e){t||warn(e);return}}function isStaticResourcesEqual(e,t){let r=/^(https?:)?\/\//i;return e.replace(r,"").replace(/\/$/,"")===t.replace(r,"").replace(/\/$/,"")}function createScript(e){let t,r=null,n=!0,i=2e4,o=document.getElementsByTagName("script");for(let t=0;t<o.length;t++){let i=o[t],l=i.getAttribute("src");if(l&&isStaticResourcesEqual(l,e.url)){r=i,n=!1;break}}if(!r){let t,n=e.attrs;(r=document.createElement("script")).type=(null==n?void 0:n.type)==="module"?"module":"text/javascript",e.createScriptHook&&((t=e.createScriptHook(e.url,e.attrs))instanceof HTMLScriptElement?r=t:"object"==typeof t&&("script"in t&&t.script&&(r=t.script),"timeout"in t&&t.timeout&&(i=t.timeout))),r.src||(r.src=e.url),n&&!t&&Object.keys(n).forEach(e=>{r&&("async"===e||"defer"===e?r[e]=n[e]:r.getAttribute(e)||r.setAttribute(e,n[e]))})}let l=async(n,i)=>{clearTimeout(t);let o=()=>{(null==i?void 0:i.type)==="error"?(null==e?void 0:e.onErrorCallback)&&(null==e||e.onErrorCallback(i)):(null==e?void 0:e.cb)&&(null==e||e.cb())};if(r&&(r.onerror=null,r.onload=null,safeWrapper(()=>{let{needDeleteScript:t=!0}=e;t&&(null==r?void 0:r.parentNode)&&r.parentNode.removeChild(r)}),n&&"function"==typeof n)){let e=n(i);if(e instanceof Promise){let t=await e;return o(),t}return o(),e}o()};return r.onerror=l.bind(null,r.onerror),r.onload=l.bind(null,r.onload),t=setTimeout(()=>{l(null,Error(`Remote script "${e.url}" time-outed.`))},i),{script:r,needAttach:n}}function createLink(e){let t=null,r=!0,n=document.getElementsByTagName("link");for(let i=0;i<n.length;i++){let o=n[i],l=o.getAttribute("href"),a=o.getAttribute("rel");if(l&&isStaticResourcesEqual(l,e.url)&&a===e.attrs.rel){t=o,r=!1;break}}if(!t){let r;(t=document.createElement("link")).setAttribute("href",e.url);let n=e.attrs;e.createLinkHook&&(r=e.createLinkHook(e.url,n))instanceof HTMLLinkElement&&(t=r),n&&!r&&Object.keys(n).forEach(e=>{t&&!t.getAttribute(e)&&t.setAttribute(e,n[e])})}let i=(r,n)=>{let i=()=>{(null==n?void 0:n.type)==="error"?(null==e?void 0:e.onErrorCallback)&&(null==e||e.onErrorCallback(n)):(null==e?void 0:e.cb)&&(null==e||e.cb())};if(t&&(t.onerror=null,t.onload=null,safeWrapper(()=>{let{needDeleteLink:r=!0}=e;r&&(null==t?void 0:t.parentNode)&&t.parentNode.removeChild(t)}),r)){let e=r(n);return i(),e}i()};return t.onerror=i.bind(null,t.onerror),t.onload=i.bind(null,t.onload),{link:t,needAttach:r}}function loadScript(e,t){let{attrs:r={},createScriptHook:n}=t;return new Promise((t,i)=>{let{script:o,needAttach:l}=createScript({url:e,cb:t,onErrorCallback:i,attrs:(0,_polyfills_esm_js__WEBPACK_IMPORTED_MODULE_0__._)({fetchpriority:"high"},r),createScriptHook:n,needDeleteScript:!0});l&&document.head.appendChild(o)})}let sdkImportCache=new Map;function importNodeModule(e){if(!e)throw Error("import specifier is required");if(sdkImportCache.has(e))return sdkImportCache.get(e);let t=Function("name","return import(name)")(e).then(e=>e).catch(t=>{throw console.error(`Error importing module ${e}:`,t),sdkImportCache.delete(e),t});return sdkImportCache.set(e,t),t}let loadNodeFetch=async()=>{let e=await importNodeModule("node-fetch");return e.default||e},lazyLoaderHookFetch=async(e,t,r)=>{let n=(e,t)=>r.lifecycle.fetch.emit(e,t),i=await n(e,t||{});return i&&i instanceof Response?i:("undefined"==typeof fetch?await loadNodeFetch():fetch)(e,t||{})},createScriptNode="undefined"==typeof ENV_TARGET||"web"!==ENV_TARGET?(url,cb,attrs,loaderHook)=>{let urlObj;if(null==loaderHook?void 0:loaderHook.createScriptHook){let hookResult=loaderHook.createScriptHook(url);hookResult&&"object"==typeof hookResult&&"url"in hookResult&&(url=hookResult.url)}try{urlObj=new URL(url)}catch(e){console.error("Error constructing URL:",e),cb(Error(`Invalid URL: ${e}`));return}let getFetch=async()=>(null==loaderHook?void 0:loaderHook.fetch)?(e,t)=>lazyLoaderHookFetch(e,t,loaderHook):"undefined"==typeof fetch?loadNodeFetch():fetch,handleScriptFetch=async(f,urlObj)=>{try{var _vm_constants,_vm_constants_USE_MAIN_CONTEXT_DEFAULT_LOADER;let res=await f(urlObj.href),data=await res.text(),[path,vm]=await Promise.all([importNodeModule("path"),importNodeModule("vm")]),scriptContext={exports:{},module:{exports:{}}},urlDirname=urlObj.pathname.split("/").slice(0,-1).join("/"),filename=path.basename(urlObj.pathname),script=new vm.Script(`(function(exports, module, require, __dirname, __filename) {${data}
})`,{filename,importModuleDynamically:null!=(_vm_constants_USE_MAIN_CONTEXT_DEFAULT_LOADER=null==(_vm_constants=vm.constants)?void 0:_vm_constants.USE_MAIN_CONTEXT_DEFAULT_LOADER)?_vm_constants_USE_MAIN_CONTEXT_DEFAULT_LOADER:importNodeModule});script.runInThisContext()(scriptContext.exports,scriptContext.module,eval("require"),urlDirname,filename);let exportedInterface=scriptContext.module.exports||scriptContext.exports;if(attrs&&exportedInterface&&attrs.globalName){let container=exportedInterface[attrs.globalName]||exportedInterface;cb(void 0,container);return}cb(void 0,exportedInterface)}catch(e){cb(e instanceof Error?e:Error(`Script execution error: ${e}`))}};getFetch().then(async e=>{if((null==attrs?void 0:attrs.type)==="esm"||(null==attrs?void 0:attrs.type)==="module")return loadModule(urlObj.href,{fetch:e,vm:await importNodeModule("vm")}).then(async e=>{await e.evaluate(),cb(void 0,e.namespace)}).catch(e=>{cb(e instanceof Error?e:Error(`Script execution error: ${e}`))});handleScriptFetch(e,urlObj)}).catch(e=>{cb(e)})}:(e,t,r,n)=>{t(Error("createScriptNode is disabled in non-Node.js environment"))},loadScriptNode="undefined"==typeof ENV_TARGET||"web"!==ENV_TARGET?(e,t)=>new Promise((r,n)=>{createScriptNode(e,(e,i)=>{if(e)n(e);else{var o,l;let e=(null==t||null==(o=t.attrs)?void 0:o.globalName)||`__FEDERATION_${null==t||null==(l=t.attrs)?void 0:l.name}:custom__`;r(globalThis[e]=i)}},t.attrs,t.loaderHook)}):(e,t)=>{throw Error("loadScriptNode is disabled in non-Node.js environment")},esmModuleCache=new Map;async function loadModule(e,t){if(esmModuleCache.has(e))return esmModuleCache.get(e);let{fetch:r,vm:n}=t,i=await r(e),o=await i.text(),l=new n.SourceTextModule(o,{importModuleDynamically:async(r,n)=>loadModule(new URL(r,e).href,t)});return esmModuleCache.set(e,l),await l.link(async r=>{let n=new URL(r,e).href;return await loadModule(n,t)}),l}function normalizeOptions(e,t,r){return function(n){if(!1===n)return!1;if(void 0===n)if(e)return t;else return!1;if(!0===n)return t;if(n&&"object"==typeof n)return(0,_polyfills_esm_js__WEBPACK_IMPORTED_MODULE_0__._)({},t,n);throw Error(`Unexpected type for \`${r}\`, expect boolean/undefined/object, got: ${typeof n}`)}}let createModuleFederationConfig=e=>e},632:function(e,t,r){r.d(t,{_:()=>n});function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}}};
//# sourceMappingURL=654.js.map